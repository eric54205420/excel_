public lastrow as integer
public lastcol as integer

Sub get_Last_Row_And_Col()
    
    lastrow = Cells(Rows.Count, ActiveCell.Column).End(xlUp).Row
    lastcol = Cells(ActiveCell.Row, Columns.Count).End(xlToLeft).Column
    MsgBox lastrow & " " & lastcol
End Sub
 

Sub auto_Fill_row_dir()
    Dim rng_row_direction As Range
    'Dim rng_col_direction As Range
   
   ' 參考左邊欄 得到應填充列數
    lastrow = Cells(Rows.Count, ActiveCell.Column - 1).End(xlUp).Row
    'lastcol = Cells(ActiveCell.Row - 1, Columns.Count).End(xlToLeft).Column
    
    ' 選取當前儲存格至該欄欄尾
     Set rng_row_direction = Range(ActiveCell, Cells(lastrow, ActiveCell.Column))
     'Set rng_col_direction = Range(Cells(ActiveCell.Row, lastcol), ActiveCell)

    ActiveCell.AutoFill Destination:=rng_row_direction
    ActiveCell.AutoFill Destination:=rng_col_direction

End Sub

Sub grab_data_except_title()

Dim curr_rows As Integer
Dim curr_cols As Integer
Dim current As Range

Set current = activecell.CurrentRegion

curr_rows = current.Rows.Count
curr_cols = current.Columns.Count


current.Resize(curr_rows - 1, curr_cols).Offset(1, 0).Select

End Sub
